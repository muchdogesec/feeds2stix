# threatfox

## tl;dr logic of the script

The script works like so


## Overview

> MalwareBazaar is a project from abuse.ch with the goal of sharing malware samples with the infosec community, AV vendors and threat intelligence providers.

https://bazaar.abuse.ch/

## Data source

https://bazaar.abuse.ch/export/csv/full/

## Data schema

```
################################################################
# MalwareBazaar full malware samples dump (CSV)                #
# Last updated: 2024-07-16 08:31:16 UTC                        #
#                                                              #
# Terms Of Use: https://bazaar.abuse.ch/faq/#tos               #
# For questions please contact bazaar [at] abuse.ch            #
################################################################
#
# "first_seen_utc","sha256_hash","md5_hash","sha1_hash","reporter","file_name","file_type_guess","mime_type","signature","clamav","vtpercent","imphash","ssdeep","tlsh"
"2024-07-16 08:31:16", "2e376f05023790d577a4d2e110640410c9d65c145d2d02e207ff07c3271ea095", "93bd5e209b3b048fa37073d7890c44d9", "da79764ed539c57542c523c28c878f6377c258a6", "SecuriteInfoCom", "SecuriteInfo.com.Win32.PWSX-gen.14862.32498", "exe", "application/x-dosexec", "n/a", "n/a", "38.36", "f34d5f2d4577ed6d9ceec516c1f5a744", "12288:T5AHEbpo6zQSxn/hqJdmVC7KDpmfYicDXFsQo1mbumYQdRlF6u:aIpo6zVQrg1RmmKm9Rv6u", "T11BF423117BFC8364C27E2B3A6074425953B1B1175863DBAF5F1CB08D2F5B3518AB3662"
"2024-07-16 08:09:21", "36ec708af0e23aa5e6cfa50dbb4327cad9c5bf25740ab5b38c7a89cf2d6617b8", "d38821792f768551b015a982c0ddd1d5", "426aff05acfcfd800a4c6f0b77fe3e92d491c3ec", "NDA0E", "gdfvr.hta", "hta", "text/html", "n/a", "n/a", "29.69", "n/a", "768:tZ6A3yXNA0AGAhUybo5ynoitI0AOgDsXxJRQiXAZO:tXFGU5", "T1E2E37C579203E53D592358FFEA3CEED110D0DE9ADBC89A4344FE5419ABE0F9CB608486"
"2024-07-16 08:07:00", "1a295933a80907bda689b231e5295eae86bd19b21964ee8669ceb5598c9d714d", "8a43a10dc1358f554584a7e8c5dfdf1a", "421b526ab7b03c4fb1529af55074b4cf1fba30af", "NDA0E", "rud.scr", "exe", "application/x-dosexec", "Loki", "n/a", "49.32", "f34d5f2d4577ed6d9ceec516c1f5a744", "6144:RwgMufVBLKEbbfYeBxZGZ+fGvcaZYE6DMQRWXu9laoMBZXVseAzBL/1nW3r3CvEa:RwfufVLG+fGvqEQqBV2hWuhb", "T1B1B4CF21A7FD6B5EF6FE1F33B7A600208B76BE22692BD35C44C4587906A3741D612723"
"2024-07-16 07:40:16", "f54bcd9b8d1f71019f83f0116ec50209aed422590555f228450da3492df76005", "59a2ee23e99471bd12e281f5a951ea04", "59cccb68067aff54b7fd81886928189599170f6a", "Bitsight", "file", "exe", "application/x-dosexec", "n/a", "n/a", "25.68", "948cc502fe9226992dce9417f952fce3", "24576:KqDEvCTbMWu7rQYlBQcBiT6rprG8aLE2Sbly7TWEPje:KTvC/MTQYxsWR7aLE2dW", "T19445BF0273D1D022FFAB92334B5BF6515ABC69260123E62F13981D79BE701B1563E7A3"
"2024-07-16 07:39:18", "1ccf2435674e5a774cbb63f1177f3ae6c592ccf152bb50986cb80e6a76c24857", "256d0da4bcd96d9016aae187faa7abc5", "3ff5126831d735d05288b541e3bfcd60a75cba1c", "cocaman", "Quotation.xls", "xls", "application/vnd.ms-excel", "n/a", "n/a", "33.85", "n/a", "12288:nTi7oLDHaQZ9Dpr6iiqtoRIGw2jqd0nm9wr:lay9DpWet2Ygaw", "T1FDA42288BB9AC703DD0B42BA46D546935424FE552FC3D617F084BB1DC8BAF639901BAC"
```

## Data Normalisation



## STIX objects

### Imported objects:

* marking-definition: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/marking-definition/feeds2stix.json
* identity: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/identity/feeds2stix.json

### Generated object mappings:

```json
{
    "type": "marking-definition",
    "spec_version": "2.1",
    "id": "marking-definition--19ca6f7b-4055-4ed5-b3d7-4b2a4f403cbb",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
    "created": "2020-01-01T00:00:00.000Z",
    "definition_type": "statement",
    "definition": {
        "statement": "Origin data source: https://sslbl.abuse.ch/blacklist/sslblacklist.csv"
    },
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
}
```