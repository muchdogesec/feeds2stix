# abuse.ch feeds


## abuse.ch SSLBL SSL Certificate Blacklist (SHA1 Fingerprints)

### Data source

https://sslbl.abuse.ch/blacklist/sslblacklist.csv

### Data schema

```
################################################################
# abuse.ch SSLBL SSL Certificate Blacklist (SHA1 Fingerprints) #
# Last updated: 2024-07-11 07:15:27 UTC                        #
#                                                              #
# Terms Of Use: https://sslbl.abuse.ch/blacklist/              #
# For questions please contact sslbl [at] abuse.ch             #
################################################################
#
# Listingdate,SHA1,Listingreason
2024-07-11 07:15:27,1bd1fee41dac6fda021becc6ed67c26e7e7315ed,Sliver C&C
2024-07-11 07:08:09,0cb3da710c6dc833050a82f4d3864c05ddcb76c8,Vidar C&C
2024-07-11 06:57:29,772c8f46f11ba3c7612b0fddc01ef4348f21483d,AsyncRAT C&C
2024-07-10 05:49:35,7332640210cc4cf0157a7d6843e9793f7d5e75bb,Vidar C&C
2024-07-10 05:49:26,6ca86b5f28ce1182eacbc9e19231dc39fc4f920a,Vidar C&C
2024-07-09 09:23:38,051b8e4f4a3e279ba2179dbf148bf6d16982b8ce,AsyncRAT C&C
2024-07-09 09:23:28,a0cf3ddb0fa7f0bdc42c025c84d9dd0e2331f832,AsyncRAT C&C
```

### Generated STIX objects

Imported objects:

* marking-definition: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/marking-definition/feeds2stix.json
* identity: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/identity/feeds2stix.json


Created by STIX2 package:

This script creates the STIX objects using the [stix2 Python Lib](https://stix2.readthedocs.io/en/latest/).

It utilises the filesystem store, which saves the output objects into a directory called `stix2_objects`. On each script run this directory is deleted and then recreated with new objects.

```json
{
    "type": "marking-definition",
    "spec_version": "2.1",
    "id": "marking-definition--418465b1-2dbe-41b7-b994-19817164e793",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
    "created": "2020-01-01T00:00:00.000Z",
    "definition_type": "statement",
    "definition": {
        "statement": "https://sslbl.abuse.ch/blacklist/sslblacklist.csv"
    },
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
}
```

```json
{
	"type": "file",
	"spec_version": "2.1",
	"id": "file--<GENERATED BY STIX2 LIB>",
	"hashes": {
		"SHA-1": "<SHA1>"
	}
}
```

```json
{
	"type": "malware",
	"spec_version": "2.1",
	"id": "malware--<UUIDV5>",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
	"created": "2020-01-01T00:00:00.000Z",
	"modified": "2020-01-01T00:00:00.000Z",
	"name": "<Listingreason> (without C&C part)",
	"malware_types": [
		"remote-access-trojan"
	],
	"is_family": true,
	"sample_refs": [
		"<ALL FILE OBJECT IDs LINKED TO <Listingreason>"
	],
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
}
```

UUIDv5 is generated using namespace `418465b1-2dbe-41b7-b994-19817164e793` and value `name`

```json
{
    "type": "indicator",
    "spec_version": "2.1",
    "id": "indicator--<SAME AS ASSOCIATED MALWARE OBJECT>",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
    "created": "Earliest <Listingdate>",
    "modified": "Latest <Listingdate>",
    "indicator_types": [
    	"malicious-activity"
    ],
    "name": "<Listingreason> (without C&C part)",
    "pattern": "([ file:hashes.'SHA-1' = '<SHA1>' ] OR [ file:hashes.'SHA-1' = '<SHA1>' ])",
    "pattern_type": "stix",
    "valid_from": "<Listingdate>",
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
  }
```

The pattern contains all file sha1 hashes linked to the malware this indicator is representing

```json
{
	"type": "relationship",
	"spec_version": "2.1",
	"id": "relationship--<UUIDV5>",
    "created": "<Listingdate>",
    "modified": "<Listingdate>",
    "relationship_type": "detects",
    "source_ref": "indicator--<ID>",
    "target_ref": "file--<ID>",
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
}
```

UUIDv5 is generated using namespace `418465b1-2dbe-41b7-b994-19817164e793` and `source_ref+target_ref`

All the generated objects are placed into STIX bundles in the `stix2_objects` directory. A bundle is generated per `<Listingreason>`

```json
{
    "type": "bundle",
    "id": "bundle--<UUIDV5>",
    "objects": [
        "ALL STIX OBJECTS CREATED"
    ]
}
```

The UUID is generated using the namespace `418465b1-2dbe-41b7-b994-19817164e793` the `name` of the malware object for the `<Listingreason>` and the last update date line shown in the header e.g `KINS MITM + # Last updated: 2024-07-11 07:15:27 UTC`

The bundle file is also names in the format `<name>.json`. Where `name` is in camel case and all `.` charachters are replaced with `_`