# abuse.ch SSLBL Botnet C2 IP Blacklist - Aggressive

## Data source

https://sslbl.abuse.ch/blacklist/sslipblacklist_aggressive.csv

## Data schema

```
################################################################
# abuse.ch SSLBL Botnet C2 IP Blacklist (CSV)                  #
# Last updated: 2024-07-10 21:06:20 UTC                        #
#                                                              #
# Terms Of Use: https://sslbl.abuse.ch/blacklist/              #
# For questions please contact sslbl [at] abuse.ch             #
################################################################
#
# Firstseen,DstIP,DstPort
2024-07-10 21:06:20,65.109.241.221,443
2024-07-10 11:18:28,15.235.151.228,8848
2024-07-09 14:27:43,158.247.208.174,443
2024-07-09 10:27:08,95.217.27.167,443
```

## Data Normalisation

n/a

## STIX objects

### Imported objects:

* marking-definition: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/marking-definition/feeds2stix.json
* identity: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/identity/feeds2stix.json

### Generated object mappings

```json
{
    "type": "marking-definition",
    "spec_version": "2.1",
    "id": "marking-definition--387824ed-ce3e-43b2-9be7-b121b2b917d9",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
    "created": "2020-01-01T00:00:00.000Z",
    "definition_type": "statement",
    "definition": {
        "statement": "Origin data source: https://sslbl.abuse.ch/blacklist/sslipblacklist_aggressive.csv"
    },
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
}
```

```json
{
	"type": "ipv4-addr",
	"spec_version": "2.1",
	"id": "ipv4-addr--<GENERATED BY STIX2 LIB>",
	"value": "<DstIP>"
}
```


```json
{
	"type": "network-traffic",
	"spec_version": "2.1",
	"id": "network-traffic--2568d22a-8998-58eb-99ec-3c8ca74f527d",
	"dst_ref": "<CORRESPONDING IPV4 ADDR OBJECT>",
	"dst_port": "<DstPort>",
	"protocols": [
		"<SEE DICTIONARY IN NOTES>"
	]
}
```

For `protocols`, if `DstPort` =

* `80` then = [`http`, `tcp`]
* `443` then = [`ssl`, `tcp`]
* any other value then = [`tcp`]

Note it may

```json
{
    "type": "indicator",
    "spec_version": "2.1",
    "id": "indicator--<UUIDv5>",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
    "created": "Earliest <Firstseen> for <DstIP>",
    "modified": "Latest <Firstseen> for <DstIP>",
    "indicator_types": [
    	"malicious-activity"
    ],
    "name": "C&C Botnet: <DstIP>",
    "pattern": "([ipv4-addr:value = '<DstIP>' AND network-traffic:dst_port = '<DstPort>'] OR [ipv4-addr:value = '<DstIP>' AND network-traffic:dst_port = '<DstPort>'])",
    "pattern_type": "stix",
    "valid_from": "<Firstseen>",
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--387824ed-ce3e-43b2-9be7-b121b2b917d9",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
  }
```

Note, it is possible that the same ID has multiple entries, with differing `<DstPort>` values. These are all captured in the `pattern` property

UUIDv5 is generated using namespace `387824ed-ce3e-43b2-9be7-b121b2b917d9` (feed marking definition uuid) and value `name`

```json
{
	"type": "relationship",
	"spec_version": "2.1",
	"id": "relationship--<same as indicator id>",
    "created": "Same as source_ref indicator",
    "modified": "Same as source_ref indicator",
    "relationship_type": "detects",
    "source_ref": "indicator--<ID>",
    "target_ref": "ipv4-addr--<ID>",
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--387824ed-ce3e-43b2-9be7-b121b2b917d9",
        "marking-definition--418465b1-2dbe-41b7-b994-19817164e793"
    ]
}
```

Note, because the Indicator represents a single ipv4-addr, only one relationship will ever exist between an indicator and ipv4-addr

All the generated objects are placed into STIX bundles directory (`bundles/abuse_ch/sslipblacklist_aggressive`).

A bundle is generated per year (containing all objects with `modified` time in the year, and all linked ipv4-addr and network-traffic object) and named as follows 2024.json, 2023.json, etc

```json
{
    "type": "bundle",
    "id": "bundle--<UUIDV5>",
    "objects": [
        "ALL STIX OBJECTS CREATED"
    ]
}
```

The UUID is generated using the namespace `387824ed-ce3e-43b2-9be7-b121b2b917d9` and an md5 of all the sorted objects in the bundle.
