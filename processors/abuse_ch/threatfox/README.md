# abuse.ch SSLBL Botnet C2 IP Blacklist - Aggressive

## Overview

> ThreatFox is a free platform from abuse.ch with the goal of sharing indicators of compromise (IOCs) associated with malware with the infosec community, AV vendors and threat intelligence providers.

https://threatfox.abuse.ch/

## Data source

https://threatfox.abuse.ch/export/csv/full/ (downloads a zip file)

## Data schema

```
################################################################
# ThreatFox IOCs: additions - CSV format (full dump)           #
# Last updated: 2024-07-12 11:30:07 UTC                        #
#                                                              #
# Terms Of Use: https://threatfox.abuse.ch/faq/#tos            #
# For questions please contact threatfox [at] abuse.ch         #
################################################################
#
# "first_seen_utc","ioc_id","ioc_value","ioc_type","threat_type","fk_malware","malware_alias","malware_printable","last_seen_utc","confidence_level","reference","tags","anonymous","reporter"
"2024-07-12 11:30:07", "1297265", "77.221.152.198:4444", "ip:port", "botnet_cc", "win.xenorat", "None", "XenoRAT", "", "100", "None", "XenoRAT", "0", "abuse_ch"
"2024-07-12 11:24:02", "1297264", "domaplc.top", "domain", "botnet_cc", "win.lokipws", "Burkina,Loki,LokiBot,LokiPWS", "Loki Password Stealer (PWS)", "2024-07-12 12:36:04", "50", "https://tracker.viriback.com/index.php?q=domaplc.top", "Lokibot,ViriBack", "0", "abuse_ch"
"2024-07-12 08:40:11", "1297263", "91.92.246.78:2404", "ip:port", "botnet_cc", "win.remcos", "RemcosRAT,Remvio,Socmer", "Remcos", "", "75", "https://bazaar.abuse.ch/sample/3ef1d040731916fee2fe1317c53a0e363f05fd12f87b84563af86ac5d49f74c2/", "remcos", "0", "abuse_ch"
"2024-07-12 07:45:10", "1297262", "212.162.149.77:1912", "ip:port", "botnet_cc", "win.redline_stealer", "RECORDSTEALER", "RedLine Stealer", "2024-07-12 08:35:08", "100", "None", "RedLineStealer", "0", "abuse_ch"
```

## Data Normalisation

n/a

## STIX objects

### Imported objects:

* marking-definition: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/marking-definition/feeds2stix.json
* identity: https://raw.githubusercontent.com/muchdogesec/stix4doge/main/objects/identity/feeds2stix.json

### Generated object mappings

#### Marking Definition

```json
{
    "type": "marking-definition",
    "spec_version": "2.1",
    "id": "marking-definition--865d4e5d-f46d-4908-b2ab-50a8f227be07",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
    "created": "2020-01-01T00:00:00.000Z",
    "definition_type": "statement",
    "definition": {
        "statement": "Origin data source: https://threatfox.abuse.ch"
    },
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--a1cb37d2-3bd3-5b23-8526-47a22694b7e0"
    ]
}
```

#### ioc_type=ip:port

If `ioc_type=ip:port` then the `ioc_value` is split at the `:` charachter. The left part is the `ipv4-addr` the right part is the `network-traffic` port.

```json
{
	"type": "ipv4-addr",
	"spec_version": "2.1",
	"id": "ipv4-addr--<GENERATED BY STIX2 LIB>",
	"value": "<VALUE IPV4>"
}
```

```json
{
	"type": "network-traffic",
	"spec_version": "2.1",
	"id": "network-traffic--<GENERATED BY STIX2 LIB>",
	"dst_ref": "<CORRESPONDING IPV4 ADDR OBJECT>",
	"dst_port": "<VALUE PORT>",
	"protocols": [
		"<SEE DICTIONARY IN NOTES>"
	]
}
```

For `protocols`, if `DstPort` =

* `80` then = [`http`, `tcp`]
* `443` then = [`ssl`, `tcp`]
* any other value then = [`tcp`]

#### ioc_type=url

```json
{  
	"type": "url",
	"spec_version": "2.1",
	"id": "url--<GENERATED BY STIX2 LIB>",
	"value": "<VALUE>"
}
```

#### ioc_type=domain

```json
{
	"type": "domain-name",
	"spec_version": "2.1",
	"id": "domain-name--<GENERATED BY STIX2 LIB>",
	"value": "<VALUE>"
}
```

#### ioc_type=md5_hash

```json
{
	"type": "file",
	"spec_version": "2.1",
	"id": "file--<GENERATED BY STIX2 LIB>",
	"hashes": {
		"MD5": "<VALUE>"
	}
}
```

#### ioc_type=sha256_hash

```json
{
	"type": "file",
	"spec_version": "2.1",
	"id": "file--<GENERATED BY STIX2 LIB>",
	"hashes": {
		"SHA-256": "<VALUE>"
	}
}
```

#### Indicators / Malware

The values are then grouped by the values in `malware_printable` to create Indicator and Malware objects as follows;

```json
{
	"type": "malware",
	"spec_version": "2.1",
	"id": "malware--<UUIDV5>",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
	"created": "Earliest <first_seen_utc>",
	"modified": "Latest <last_seen_utc>",
	"name": "<malware_printable>",
	"malware_types": [
		"unknown"
	],
	"aliases": [
		"<malware_alias>"
	],
	"is_family": true,
	"sample_refs": [
		"<ALL IPV4/NETWORK TRAFFIC/DOMAIN/URL/FILE OBJECT IDs FOR ROWS WITH MALWARE>"
	],
	"labels": [
		"<tags>"
	],
	"confidence": "<confidence_level>",
	"external_references": [
		{
			"source_name": "threatfox_ioc_id",
			"external_id": "<ioc_id>"
	    },
		{
			"source_name": "threatfox_ioc_reporter",
			"external_id": "<reporter>"
	    }
	],
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--865d4e5d-f46d-4908-b2ab-50a8f227be07",
        "marking-definition--418465b1-2dbe-41b7-b994-19817164e793"
    ]
}
```

UUIDv5 is generated using namespace `865d4e5d-f46d-4908-b2ab-50a8f227be07` and `name` value

```json
{
    "type": "indicator",
    "spec_version": "2.1",
    "id": "indicator--<SAME AS MALWARE UUID>",
    "created_by_ref": "identity--a1cb37d2-3bd3-5b23-8526-47a22694b7e0",
    "created": "Earliest <first_seen_utc>",
    "modified": "Latest <last_seen_utc>",
    "indicator_types": [
    	"malicious-activity"
    ],
    "name": "<malware_printable>",
    "pattern": "<STIX PATTERN FOR EACH SCO LINKED TO MALWARE JOINED WITH OR OPERATORS>",
    "pattern_type": "stix",
    "valid_from": "Earliest <first_seen_utc>",
	"labels": [
		"<tags>"
	],
	"confidence": "<confidence_level>",
	"external_references": [
		{
			"source_name": "threatfox_ioc_id",
			"external_id": "<ioc_id>"
	    },
		{
			"source_name": "threatfox_ioc_reporter",
			"external_id": "<reporter>"
	    }
	],
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--865d4e5d-f46d-4908-b2ab-50a8f227be07",
        "marking-definition--418465b1-2dbe-41b7-b994-19817164e793"
    ]
  }
```

```json
{
	"type": "relationship",
	"spec_version": "2.1",
	"id": "relationship--<same as indicator id>",
    "created": "<first_seen_utc> for row target_ref object",
    "modified": "<last_seen_utc> for row target_ref object",
    "relationship_type": "detects",
    "source_ref": "indicator--<ID>",
    "target_ref": "<OBJECT_ID>",
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--865d4e5d-f46d-4908-b2ab-50a8f227be07",
        "marking-definition--418465b1-2dbe-41b7-b994-19817164e793"
    ]
}
```

UUIDv5 is generated using namespace `865d4e5d-f46d-4908-b2ab-50a8f227be07` and `source_ref+target_ref`